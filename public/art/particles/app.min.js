var canvas=document.getElementById("canvas"),c=canvas.getContext("2d"),time=null;canvas.width=window.innerWidth,canvas.height=window.innerHeight;var mouse={x:window.innerWidth/2,y:window.innerHeight/2},mouseposition={x:innerWidth/2,y:innerHeight/2},mousedown=!1;window.addEventListener("mousedown",function(t){mouseposition.x=t.clientX,mouseposition.y=t.clientY,mousedown=!0,time=(new Date).getTime()}),window.addEventListener("mouseup",function(t){mousedown=!1}),window.addEventListener("mousemove",function(t){mouse.x=t.clientX,mouse.y=t.clientY}),window.addEventListener("resize",function(){canvas.width=window.innerWidth,canvas.height=window.innerHeight,init()});var particles,colors=[{r:255,g:71,b:71},{r:0,g:206,b:237},{r:255,g:255,b:255}];function Particle(t,i,e,s,n){this.x=t,this.y=i,this.radius=n,this.randomColor=Math.floor(Math.random()*colors.length),this.mass=1,this.opacity=1,this.deleted=!1,this.timeToLive=8,this.type=e&&s?"T1":"T2",this.velocity={x:e||4*(Math.random()-.5),y:s||4*(Math.random()-.5)}}function randomIntFromRange(t,i){return Math.floor(Math.random()*(i-t+1)+t)}function distance(t,i,e,s){return Math.sqrt(Math.pow(e-t,2)+Math.pow(s-i,2))}function rotate(t,i){return{x:t.x*Math.cos(i)-t.y*Math.sin(i),y:t.x*Math.sin(i)+t.y*Math.cos(i)}}function resolveCollision(t,i){const e=t.velocity.x-i.velocity.x,s=t.velocity.y-i.velocity.y;if(e*(i.x-t.x)+s*(i.y-t.y)>=0){const e=-Math.atan2(i.y-t.y,i.x-t.x),s=t.mass,n=i.mass,o=rotate(t.velocity,e),a=rotate(i.velocity,e),h={x:o.x*(s-n)/(s+n)+2*a.x*n/(s+n),y:o.y},r={x:a.x*(s-n)/(s+n)+2*o.x*n/(s+n),y:a.y},c=rotate(h,-e),l=rotate(r,-e);t.velocity.x=c.x,t.velocity.y=c.y,i.velocity.x=l.x,i.velocity.y=l.y}}function init(){particles=[];for(let t=0;t<70;t++){let t=randomIntFromRange(30,window.innerWidth-30),i=randomIntFromRange(30,window.innerHeight-30);for(let e=0;e<particles.length;e++)distance(t,i,particles[e].x,particles[e].y)-60<1&&(t=randomIntFromRange(30,window.innerWidth-30),i=randomIntFromRange(30,window.innerHeight-30),e=-1);particles.push(new Particle(t,i,null,null,30))}}function animate(){0!=particles.length&&(requestAnimationFrame(animate),c.fillStyle="rgba(0, 0, 0, 0.05)",c.fillRect(0,0,canvas.width,canvas.height),particles.forEach(t=>{t.update(particles)}),0===(particles=particles.filter(t=>!t.deleted)).length&&(c.fillStyle="rgba(0, 0, 0)",c.fillRect(0,0,canvas.width,canvas.height),time=null,animateExplosions()))}function Explosion(t,i){this.particles=[],this.init=function(){for(var e=1;e<=1;e++){var s={x:3.5*(Math.random()-.5),y:3.5*(Math.random()-.5)};this.particles.push(new Particle(t,i,s.x,s.y,30))}},this.init(),this.draw=function(){for(var t=0;t<this.particles.length;t++)this.particles[t].update(),1==this.particles[t].remove()&&this.particles.splice(t,1)}}Particle.prototype.remove=function(){return this.timeToLive<=0},Particle.prototype.update=function(t){if(this.draw(),"T2"===this.type){if(mousedown){let t=mouseposition.x-this.x,i=mouseposition.y-this.y;Math.sqrt(Math.pow(t,2)+Math.pow(i,2))>90&&(this.x+=.05*t,this.y+=.05*i)}for(let i=0;i<t.length;i++)this!==t[i]&&distance(this.x,this.y,t[i].x,t[i].y)-2*this.radius<=0&&resolveCollision(this,t[i]);(this.x-this.radius<=0||this.x+this.radius>=window.innerWidth)&&(this.velocity.x=-this.velocity.x),(this.y-this.radius<=0||this.y+this.radius>=window.innerHeight)&&(this.velocity.y=-this.velocity.y)}this.x+=this.velocity.x,this.y+=this.velocity.y,mousedown&&(new Date).getTime()-time>3e3&&(this.deleted=!0),"T1"===this.type&&((this.x+this.radius>=canvas.width||this.x-this.radius<=0)&&(this.dx=-this.dx),(this.y+this.radius>=canvas.height||this.y-this.radius<=0)&&(this.dy=-this.dy),this.x=Math.min(Math.max(this.x,0+this.radius),canvas.width-this.radius),this.y=Math.min(Math.max(this.y,0+this.radius),canvas.height-this.radius),this.opacity-=1/(this.timeToLive/.01),this.radius-=this.radius/(this.timeToLive/.01),this.radius<0&&(this.radius=0),this.timeToLive-=.01)},Particle.prototype.draw=function(){c.beginPath(),c.arc(this.x,this.y,this.radius,0,2*Math.PI),c.strokeStyle="rgba("+colors[this.randomColor].r+","+colors[this.randomColor].g+","+colors[this.randomColor].b+","+this.opacity+")",c.stroke(),c.closePath()};var explosions=[];function animateExplosions(){window.requestAnimationFrame(animateExplosions),c.fillStyle="#1e1e1e",c.fillRect(0,0,canvas.width,canvas.height),explosions.push(new Explosion(mouse.x,mouse.y));for(var t=0;t<explosions.length;t++)explosions[t].draw()}init(),animate();