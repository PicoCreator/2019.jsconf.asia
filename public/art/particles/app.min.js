var canvas=document.getElementById("canvas"),time=null;canvas.width=window.innerWidth,canvas.height=window.innerHeight;var c=canvas.getContext("2d"),mouse={x:window.innerWidth/2,y:window.innerHeight/2},mouseposition={x:innerWidth/2,y:innerHeight/2},mousedown=!1;isMobile()||(window.parent.addEventListener("mousedown",function(i){mouseposition.x=i.clientX,mouseposition.y=i.clientY,mousedown=!0,time=(new Date).getTime()}),window.parent.addEventListener("mouseup",function(i){mousedown=!1}),window.parent.addEventListener("mousemove",function(i){mouse.x=i.clientX,mouse.y=i.clientY}),window.parent.addEventListener("resize",function(){canvas.width=window.innerWidth,canvas.height=window.innerHeight,init()}));var particles,colors=[{r:255,g:71,b:71},{r:0,g:206,b:237},{r:255,g:255,b:255}];function Particle(i,t,e,n,s){this.x=i,this.y=t,this.radius=s,this.randomColor=Math.floor(Math.random()*colors.length),this.mass=1,this.opacity=1,this.deleted=!1,this.timeToLive=8,this.type=e&&n?"T1":"T2",this.velocity={x:e||4*(Math.random()-.5),y:n||4*(Math.random()-.5)}}function randomIntFromRange(i,t){return Math.floor(Math.random()*(t-i+1)+i)}function distance(i,t,e,n){return Math.sqrt(Math.pow(e-i,2)+Math.pow(n-t,2))}function rotate(i,t){return{x:i.x*Math.cos(t)-i.y*Math.sin(t),y:i.x*Math.sin(t)+i.y*Math.cos(t)}}function resolveCollision(i,t){const e=i.velocity.x-t.velocity.x,n=i.velocity.y-t.velocity.y;if(e*(t.x-i.x)+n*(t.y-i.y)>=0){const e=-Math.atan2(t.y-i.y,t.x-i.x),n=i.mass,s=t.mass,o=rotate(i.velocity,e),a=rotate(t.velocity,e),r={x:o.x*(n-s)/(n+s)+2*a.x*s/(n+s),y:o.y},h={x:a.x*(n-s)/(n+s)+2*o.x*s/(n+s),y:a.y},c=rotate(r,-e),l=rotate(h,-e);i.velocity.x=c.x,i.velocity.y=c.y,t.velocity.x=l.x,t.velocity.y=l.y}}function init(){particles=[];for(let i=0;i<70;i++){let i=randomIntFromRange(30,window.innerWidth-30),t=randomIntFromRange(30,window.innerHeight-30);for(let e=0;e<particles.length;e++)distance(i,t,particles[e].x,particles[e].y)-60<1&&(i=randomIntFromRange(30,window.innerWidth-30),t=randomIntFromRange(30,window.innerHeight-30),e=-1);particles.push(new Particle(i,t,null,null,30))}}function animate(){0!=particles.length&&(requestAnimationFrame(animate),c.fillStyle="rgba(0, 0, 0, 0.05)",c.fillRect(0,0,window.innerWidth-8,window.innerHeight-8),particles.forEach(i=>{i.update(particles)}),0===(particles=particles.filter(i=>!i.deleted)).length&&(c.fillStyle="rgba(0, 0, 0)",c.fillRect(0,0,window.innerWidth-8,window.innerHeight-8),time=null,animateExplosions()))}function Explosion(i,t){this.particles=[],this.init=function(){for(var e=1;e<=1;e++){var n={x:3.5*(Math.random()-.5),y:3.5*(Math.random()-.5)};this.particles.push(new Particle(i,t,n.x,n.y,30))}},this.init(),this.draw=function(){for(var i=0;i<this.particles.length;i++)this.particles[i].update(),1==this.particles[i].remove()&&this.particles.splice(i,1)}}Particle.prototype.remove=function(){return this.timeToLive<=0},Particle.prototype.update=function(i){if(this.draw(),"T2"===this.type){if(mousedown){let i=mouseposition.x-this.x,t=mouseposition.y-this.y;Math.sqrt(Math.pow(i,2)+Math.pow(t,2))>90&&(this.x+=.05*i,this.y+=.05*t)}for(let t=0;t<i.length;t++)this!==i[t]&&distance(this.x,this.y,i[t].x,i[t].y)-2*this.radius<=0&&resolveCollision(this,i[t]);(this.x-this.radius<=0||this.x+this.radius>=window.innerWidth)&&(this.velocity.x=-this.velocity.x),(this.y-this.radius<=0||this.y+this.radius>=window.innerHeight)&&(this.velocity.y=-this.velocity.y)}this.x+=this.velocity.x,this.y+=this.velocity.y,mousedown&&(new Date).getTime()-time>2e3&&(this.deleted=!0),"T1"===this.type&&((this.x+this.radius>=canvas.width||this.x-this.radius<=0)&&(this.dx=-this.dx),(this.y+this.radius>=canvas.height||this.y-this.radius<=0)&&(this.dy=-this.dy),this.x=Math.min(Math.max(this.x,0+this.radius),canvas.width-this.radius),this.y=Math.min(Math.max(this.y,0+this.radius),canvas.height-this.radius),this.opacity-=1/(this.timeToLive/.01),this.radius-=this.radius/(this.timeToLive/.01),this.radius<0&&(this.radius=0),this.timeToLive-=.01)},Particle.prototype.draw=function(){c.beginPath(),c.arc(this.x,this.y,this.radius,0,2*Math.PI),c.strokeStyle="rgba("+colors[this.randomColor].r+","+colors[this.randomColor].g+","+colors[this.randomColor].b+","+this.opacity+")",c.stroke(),c.closePath()};var explosions=[];function animateExplosions(){window.requestAnimationFrame(animateExplosions),c.fillStyle="#1e1e1e",c.fillRect(0,0,canvas.width,canvas.height),explosions.push(new Explosion(mouse.x,mouse.y));for(var i=0;i<explosions.length;i++)explosions[i].draw()}function isMobile(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}init(),animate();